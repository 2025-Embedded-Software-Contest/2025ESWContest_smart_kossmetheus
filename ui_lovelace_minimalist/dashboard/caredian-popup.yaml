---
# CareDian Bubble Card Pop-up 설정
# 예시 사진과 같은 팝업 인터페이스 구현

button_card_templates: !include_dir_merge_named "../ulm_templates/"

title: "CareDian Pop-up Interface"
theme: "minimalist-mobile"

views:
  - title: "팝업 인터페이스"
    path: popup-interface
    icon: "mdi:gesture-tap"
    cards:
      # 메인 팝업 트리거 버튼들
      - type: "vertical-stack"
        cards:
          - type: "custom:button-card"
            template: "card_title"
            name: "디바이스 제어 센터"
            label: "터치하여 각 카테고리 제어"
            
          - type: "grid"
            columns: 2
            square: false
            cards:
              # Device 팝업 트리거
              - type: "custom:bubble-card"
                card_type: "button"
                entity: "group.all_devices"
                name: "Device"
                icon: "mdi:devices"
                show_state: true
                show_attribute: true
                attribute: "friendly_name"
                tap_action:
                  action: "fire-dom-event"
                  bubble_action:
                    service: "browser_mod.popup"
                    data:
                      title: "디바이스 제어"
                      content:
                        type: "vertical-stack"
                        cards:
                          - type: "custom:mushroom-chips-card"
                            chips:
                              - type: "entity"
                                entity: "switch.computer_block"
                                name: "컴퓨터 차단"
                                icon: "mdi:desktop-classic"
                              - type: "entity"
                                entity: "switch.network_control"
                                name: "네트워크 제어"
                                icon: "mdi:network"
                              - type: "entity"
                                entity: "switch.sync_box"
                                name: "Sync Box"
                                icon: "mdi:monitor"
                card_mod:
                  style: |
                    ha-card {
                      background-color: rgba(255, 0, 0, 0.1);
                      border-radius: 20px;
                    }
                    
              # Light 팝업 트리거
              - type: "custom:bubble-card"
                card_type: "button"
                entity: "group.all_lights"
                name: "Light"
                icon: "mdi:lightbulb"
                show_state: true
                tap_action:
                  action: "fire-dom-event"
                  bubble_action:
                    service: "browser_mod.popup"
                    data:
                      title: "조명 제어"
                      content:
                        type: "vertical-stack"
                        cards:
                          - type: "custom:mushroom-light-card"
                            entity: "light.living_room"
                            name: "거실 조명"
                            use_light_color: true
                            show_brightness_control: true
                          - type: "custom:mushroom-light-card"
                            entity: "light.bedroom"
                            name: "침실 조명"
                            use_light_color: true
                            show_brightness_control: true
                          - type: "custom:mushroom-light-card"
                            entity: "light.kitchen"
                            name: "주방 조명"
                            use_light_color: true
                            show_brightness_control: true
                card_mod:
                  style: |
                    ha-card {
                      background-color: rgba(255, 165, 0, 0.1);
                      border-radius: 20px;
                    }
                    
              # Switch 팝업 트리거  
              - type: "custom:bubble-card"
                card_type: "button"
                entity: "group.all_switches"
                name: "Switch"
                icon: "mdi:toggle-switch"
                show_state: true
                tap_action:
                  action: "fire-dom-event"
                  bubble_action:
                    service: "browser_mod.popup"
                    data:
                      title: "스위치 제어"
                      content:
                        type: "entities"
                        entities:
                          - entity: "switch.living_room_power"
                            name: "거실 전원"
                          - entity: "switch.bedroom_power"
                            name: "침실 전원"
                          - entity: "switch.kitchen_power"
                            name: "주방 전원"
                          - entity: "switch.balcony_power"
                            name: "베란다 전원"
                card_mod:
                  style: |
                    ha-card {
                      background-color: var(--card-background-color);
                      border-radius: 20px;
                    }
                    
              # Fan 팝업 트리거
              - type: "custom:bubble-card"
                card_type: "button"
                entity: "group.all_fans"
                name: "Fan"
                icon: "mdi:fan"
                show_state: true
                tap_action:
                  action: "fire-dom-event"
                  bubble_action:
                    service: "browser_mod.popup"
                    data:
                      title: "팬 제어"
                      content:
                        type: "vertical-stack"
                        cards:
                          - type: "custom:mushroom-fan-card"
                            entity: "fan.living_room"
                            name: "거실 선풍기"
                            show_percentage_control: true
                            show_oscillate_control: true
                          - type: "custom:mushroom-fan-card"
                            entity: "fan.bedroom"
                            name: "침실 선풍기"
                            show_percentage_control: true
                            show_oscillate_control: true
                          - type: "custom:mushroom-fan-card"
                            entity: "fan.kitchen"
                            name: "주방 환풍기"
                            show_percentage_control: true
                            show_oscillate_control: true
                card_mod:
                  style: |
                    ha-card {
                      background-color: rgba(0, 191, 255, 0.1);
                      border-radius: 20px;
                    }

      # 센서 모니터링 섹션
      - type: "vertical-stack"
        cards:
          - type: "custom:button-card"
            template: "card_title"
            name: "센서 모니터링"
            
          - type: "grid"
            columns: 2
            square: false
            cards:
              # 온도 센서 팝업
              - type: "custom:bubble-card"
                card_type: "button"
                entity: "sensor.average_temperature"
                name: "온도"
                icon: "mdi:thermometer"
                show_state: true
                show_last_changed: true
                tap_action:
                  action: "fire-dom-event"
                  bubble_action:
                    service: "browser_mod.popup"
                    data:
                      title: "온도 센서"
                      content:
                        type: "vertical-stack"
                        cards:
                          - type: "custom:mushroom-entity-card"
                            entity: "sensor.living_room_temperature"
                            name: "거실"
                          - type: "custom:mushroom-entity-card"
                            entity: "sensor.bedroom_temperature"  
                            name: "침실"
                          - type: "custom:mushroom-entity-card"
                            entity: "sensor.kitchen_temperature"
                            name: "주방"
                card_mod:
                  style: |
                    ha-card {
                      background-color: rgba(255, 0, 0, 0.1);
                      border-radius: 20px;
                    }
                    
              # 습도 센서 팝업  
              - type: "custom:bubble-card"
                card_type: "button"
                entity: "sensor.average_humidity"
                name: "습도"
                icon: "mdi:water-percent"
                show_state: true
                show_last_changed: true
                tap_action:
                  action: "fire-dom-event"
                  bubble_action:
                    service: "browser_mod.popup"
                    data:
                      title: "습도 센서"
                      content:
                        type: "history-graph"
                        entities:
                          - entity: "sensor.living_room_humidity"
                            name: "거실"
                          - entity: "sensor.bedroom_humidity"
                            name: "침실"
                          - entity: "sensor.kitchen_humidity"
                            name: "주방"
                        hours_to_show: 24
                        refresh_interval: 300
                card_mod:
                  style: |
                    ha-card {
                      background-color: rgba(0, 0, 255, 0.1);
                      border-radius: 20px;
                    }
                    
              # 전기 사용량 팝업
              - type: "custom:bubble-card"
                card_type: "button"
                entity: "sensor.total_energy_consumption"
                name: "전기"
                icon: "mdi:lightning-bolt"
                show_state: true
                tap_action:
                  action: "fire-dom-event"
                  bubble_action:
                    service: "browser_mod.popup"
                    data:
                      title: "전력 모니터링"
                      content:
                        type: "vertical-stack"
                        cards:
                          - type: "energy-usage-graph"
                            entities:
                              - entity: "sensor.energy_consumption"
                          - type: "custom:mushroom-entity-card"
                            entity: "sensor.monthly_energy_cost"
                            name: "월 전기요금"
                card_mod:
                  style: |
                    ha-card {
                      background-color: rgba(255, 255, 0, 0.1);
                      border-radius: 20px;
                    }
                    
              # CO2 센서 팝업
              - type: "custom:bubble-card"
                card_type: "button"
                entity: "sensor.average_co2"
                name: "CO₂"
                icon: "mdi:molecule-co2"
                show_state: true
                tap_action:
                  action: "fire-dom-event"
                  bubble_action:
                    service: "browser_mod.popup"
                    data:
                      title: "공기질 모니터링"
                      content:
                        type: "vertical-stack"
                        cards:
                          - type: "gauge"
                            entity: "sensor.co2_level"
                            name: "CO₂ 농도"
                            min: 0
                            max: 2000
                            severity:
                              green: 0
                              yellow: 800
                              red: 1200
                          - type: "custom:mushroom-entity-card"
                            entity: "sensor.air_quality_index"
                            name: "공기질 지수"
                card_mod:
                  style: |
                    ha-card {
                      background-color: rgba(0, 255, 0, 0.1);
                      border-radius: 20px;
                    }
